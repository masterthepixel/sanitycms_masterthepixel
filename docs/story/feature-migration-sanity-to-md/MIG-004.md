# MIG-004 — Replace blog listing & post pages to use file content

Branch: feature/migration/sanity-to-md/mig-004
Priority: High
Estimate: 8–16 hours
Assignee: @frontend-dev (suggested) — blog rendering owner

## Goal
Replace `sanityFetch` usages for blog listing and post detail pages with `src/lib/content.ts` and MDX rendering.

## Acceptance criteria
- Blog list and individual post pages are served from `content/` files
- `generateStaticParams` / `generateMetadata` read frontmatter
- Tests (unit + e2e) updated and passing

## Developer tasks (developer-ready, assignable)
1. Data layer swap (1–2h)
   - Replace `sanityFetch` call sites in `src/app/(frontend)/blog/page.tsx` and `src/app/(frontend)/blog/[slug]/page.tsx` with `await getAllPosts()` / `getPostBySlug()` from `src/lib/content.ts`.
   - Remove/guard `sanityFetch` imports with TODO comments for later cleanup.
2. Rendering swap (1–2h)
   - Replace `PortableTextViewer` usage with `MDXRenderer` in `src/app/(frontend)/blog/_components/post-content.tsx` or equivalent.
   - Implement fallback path if `body` is missing (log and render excerpt).
3. Metadata & build (1h)
   - Update `generateStaticParams`/`generateMetadata` to read frontmatter values (title, description, openGraphImage).
4. Search/index (1h)
   - Add `content/posts.json` generation in build or as artifact from converter.
   - Update `src/app/(frontend)/blog/_components/blog-search.tsx` to consume new index shape.
5. Tests & e2e (2–3h)
   - Update unit tests that expected Sanity shapes to use PostFrontmatter type.
   - Update Playwright tests: `tests/e2e/home.spec.ts` and add `tests/e2e/blog.spec.ts` for sample posts.

Dev acceptance checklist
- [ ] Blog pages render from MDX files and pass unit tests
- [ ] `generateStaticParams` returns same slugs as before (compare counts)
- [ ] Playwright e2e updated and passing
- [ ] PR merged into epic branch


## Done checklist
- [ ] Blog listing and post pages use file content
- [ ] All updated tests pass
- [ ] PR merged into epic branch
